!function(i){var n,t,a,s,r=1e3*ina_meta_data.ina_timeout,c=0,u={},_=10,d={onReady:function(){this.setupDOM(),this.eventListeners()},setupDOM:function(){u.stayLoggedIn=i(".ina_stay_logged_in"),u.popupBG=i(".ina__no_confict_popup_bg"),u.msg_box=i("#ina__dp_logout_message_box"),u.msg_boxBody=i("#ina__dp_logout_message_box .ina-dp-noflict-modal-body"),u.countdown=i(".ina_countdown")},eventListeners:function(){i(document).on("mousemove",d.resetTimer),i(document).on("mousedown",d.resetTimer),i(document).on("keydown",d.resetTimer),i(document).on("DOMMouseScroll",d.resetTimer),i(document).on("mousewheel",d.resetTimer),i(document).on("touchmove",d.resetTimer),i(document).on("MSPointerMove",d.resetTimer),i(window).on("load",d.resetTimer),u.stayLoggedIn.on("click",d.stayLoggedInWarnMsg),t=sessionStorage.inactive_logout_tabID&&"2"!==sessionStorage.closedLastTab?sessionStorage.inactive_logout_tabID:sessionStorage.inactive_logout_tabID=Math.random(),sessionStorage.closedLastTab="2",i(window).on("unload beforeunload",function(){sessionStorage.closedLastTab="1"}),localStorage.setItem("ina__browserTabID",t),this.startTimer()},startTimer:function(){n=setTimeout(d.goInactive,11e3)},resetTimer:function(){clearTimeout(n),clearTimeout(a),localStorage.setItem("ina__browserTabID",t);try{d.startTimer()}catch(o){TypeError,console.log(o,!0)}},goInactive:function(){var o,e,n;0===c&&(o=Date.now(),e=Math.floor(o/1e3),n={action:"ina_checklastSession",do:"ina_updateLastSession",security:ina_ajax.ina_security,timestamp:e},i.post(ina_ajax.ajaxurl,n).done(function(o){var e=document.activeElement;if(e&&("IFRAME"===e.tagName||e.classList.contains("media-modal")))return d.resetTimer(),!1;localStorage.getItem("ina__browserTabID")===t&&(a=setTimeout(d.showTimeoutMessage,r))}))},showTimeoutMessage:function(){var e,o,n,t=ina_meta_data.ina_disable_countdown,a=ina_meta_data.ina_warn_message_enabled;document.onkeydown=function(o){if(116!=(o.charCode||o.keyCode))return!1},window.oncontextmenu=function(){return!1},u.popupBG.data("bgenabled")&&(o=u.popupBG.data("bg"),u.msg_box.css("background",o)),c=1,a?u.msg_box.show():t?(n={action:"ina_checklastSession",do:"ina_logout",security:ina_ajax.ina_security},i.post(ina_ajax.ajaxurl,n).done(function(o){return o.redirect_url?(u.msg_box.show(),u.msg_boxBody.html("<p>"+o.msg+"<p>"),d.logout_now(o.redirect_url)):(u.msg_box.show(),u.msg_boxBody.html("<p>"+o.msg+'</p><p class="ina-dp-noflict-btn-container"><a class="btn-timeout" href="javascript:void(0);" onclick="window.location.reload();">OK</a></p>'),d.logout_now(!1)),!1})):(_=10,u.msg_box.show(),s=setInterval(function(){var o;0<=_&&(e=_--,u.countdown.html("("+e+")")),0===e&&(clearTimeout(s),o={action:"ina_checklastSession",do:"ina_logout",security:ina_ajax.ina_security},i.post(ina_ajax.ajaxurl,o).done(function(o){return o.redirect_url?(u.msg_boxBody.html("<p>"+o.msg+"<p>"),d.logout_now(o.redirect_url)):(u.msg_boxBody.html("<p>"+o.msg+'</p><p class="ina-dp-noflict-btn-container"><a class="btn-timeout" href="javascript:void(0);" onclick="window.location.reload();">OK</a></p>'),d.logout_now(!1)),!1}))},1e3))},stayLoggedInWarnMsg:function(){document.onkeydown=function(o){return!0},window.oncontextmenu=null,clearTimeout(s),_=10,c=0,u.msg_box.hide(),u.countdown.text("")},logout_now:function(o){var e={action:"ina_logout_session",security:ina_ajax.ina_security};i.post(ina_ajax.ajaxurl,e).done(function(){clearTimeout(n),o&&(localStorage.removeItem("ina__browserTabID"),window.location=o),console.log("Session Logged Out !!")})}};i(function(){d.onReady()})}(jQuery);