!function(i){var n,t,a,s,r=1e3*ina_meta_data.ina_timeout,c=0,u={},_=10,l={onReady:function(){this.setupDOM(),this.eventListeners()},setupDOM:function(){u.stayLoggedIn=i(".ina_stay_logged_in"),u.popupBG=i(".ina__no_confict_popup_bg"),u.msg_box=i("#ina__dp_logout_message_box"),u.msg_boxBody=i("#ina__dp_logout_message_box .ina-dp-noflict-modal-body"),u.countdown=i(".ina_countdown")},eventListeners:function(){i(document).on("mousemove",l.resetTimer),i(document).on("mousedown",l.resetTimer),i(document).on("keydown",l.resetTimer),i(document).on("DOMMouseScroll",l.resetTimer),i(document).on("mousewheel",l.resetTimer),i(document).on("touchmove",l.resetTimer),i(document).on("MSPointerMove",l.resetTimer),i(window).on("load",l.resetTimer),u.stayLoggedIn.on("click",l.stayLoggedInWarnMsg),t=sessionStorage.inactive_logout_tabID&&"2"!==sessionStorage.closedLastTab?sessionStorage.inactive_logout_tabID:sessionStorage.inactive_logout_tabID=Math.random(),sessionStorage.closedLastTab="2",i(window).on("unload beforeunload",function(){sessionStorage.closedLastTab="1"}),localStorage.setItem("ina__browserTabID",t),this.startTimer()},startTimer:function(){n=setTimeout(l.goInactive,11e3)},resetTimer:function(){clearTimeout(n),clearTimeout(a),localStorage.setItem("ina__browserTabID",t);try{l.startTimer()}catch(o){TypeError,console.log(o,!0)}},goInactive:function(){if(0===c){var o=Date.now(),e=Math.floor(o/1e3),n={action:"ina_checklastSession",do:"ina_updateLastSession",security:ina_ajax.ina_security,timestamp:e};i.post(ina_ajax.ajaxurl,n).done(function(o){var e=document.activeElement;if(e&&("IFRAME"===e.tagName||e.classList.contains("media-modal")))return l.resetTimer(),!1;localStorage.getItem("ina__browserTabID")===t&&(a=setTimeout(l.showTimeoutMessage,r))})}},showTimeoutMessage:function(){var e,o=ina_meta_data.ina_disable_countdown,n=ina_meta_data.ina_warn_message_enabled;if(document.onkeydown=function(o){if(116!=(o.charCode||o.keyCode))return!1},window.oncontextmenu=function(){return!1},u.popupBG.data("bgenabled")){var t=u.popupBG.data("bg");u.msg_box.css("background",t)}if(c=1,n)u.msg_box.show();else if(o){var a={action:"ina_checklastSession",do:"ina_logout",security:ina_ajax.ina_security};i.post(ina_ajax.ajaxurl,a).done(function(o){return o.redirect_url?(u.msg_box.show(),u.msg_boxBody.html("<p>"+o.msg+"<p>"),l.logout_now(o.redirect_url)):(u.msg_box.show(),u.msg_boxBody.html("<p>"+o.msg+'</p><p class="ina-dp-noflict-btn-container"><a class="btn-timeout" href="javascript:void(0);" onclick="window.location.reload();">OK</a></p>'),l.logout_now(!1)),!1})}else _=10,u.msg_box.show(),s=setInterval(function(){if(0<=_&&(e=_--,u.countdown.html("("+e+")")),0===e){clearTimeout(s);var o={action:"ina_checklastSession",do:"ina_logout",security:ina_ajax.ina_security};i.post(ina_ajax.ajaxurl,o).done(function(o){return o.redirect_url?(u.msg_boxBody.html("<p>"+o.msg+"<p>"),l.logout_now(o.redirect_url)):(u.msg_boxBody.html("<p>"+o.msg+'</p><p class="ina-dp-noflict-btn-container"><a class="btn-timeout" href="javascript:void(0);" onclick="window.location.reload();">OK</a></p>'),l.logout_now(!1)),!1})}},1e3)},stayLoggedInWarnMsg:function(){document.onkeydown=function(o){return!0},window.oncontextmenu=null,clearTimeout(s),_=10,c=0,u.msg_box.hide(),u.countdown.text("")},logout_now:function(o){var e={action:"ina_logout_session",security:ina_ajax.ina_security};i.post(ina_ajax.ajaxurl,e).done(function(){clearTimeout(n),o&&(localStorage.removeItem("ina__browserTabID"),window.location=o),console.log("Session Logged Out !!")})}};i(function(){l.onReady()})}(jQuery);